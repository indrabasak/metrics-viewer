!function(e,t){"function"==typeof define&&define.amd?define(["jquery","MG"],t):"object"==typeof exports?module.exports=t(require("jquery"),require("MG")):e.metricsViewer=t(e.jQuery,e.MG)}(this,function(e,t){return function(e,n){"use strict";function l(e,n){this.date=t.clone(e),this.value=n}function a(e,t,n,l){this.legend=e,this.key=t,this.metricName=n,this.altMetricName=l}function i(e,l,a,i,u,r,s,d,h,m,v,c){function E(e,t){var n=null;if(e instanceof HTMLElement)n=e.id;else{n=e;var l=e.charAt(0);"#"===l&&(n=e.substring(1))}return n+"."+t}this.divId=e,this.childDiv=l,this.metricType=a,this.metricName=i,this.title=u,this.description=r,this.values=s,this.legendData=d,this.legend=[],this.x_label=h,this.y_label=m,this.y_label_key=v,this.legendDivId=null,this.ignoreMetricName=c,this.initialized=!1;for(var _=0;_<this.legendData.length;_++)this.legend.push(this.legendData[_].legend);this.render=function(){var e=null;if(!this.initialized){if(n(this.divId).is(":empty")){var l=n("<h3>").text(this.title);n(this.divId).append(l);var a=n("<hr>").addClass("mv-title-hr");n(this.divId).append(a),e=E(this.divId,"container");var i=n("<div></div>").attr("id",e).addClass("mv-outer");n(this.divId).append(i),this.divId=document.getElementById(e)}else e=E(this.divId,"container"),this.divId=document.getElementById(e);if(this.childDiv){var u=E(this.divId,this.childDiv),r=n("<div></div>").attr("id",u).addClass("mv-inner");n(r).css("width",p).css("height",f*y),n(this.divId).append(r),this.title=o(this.childDiv);var s=E(u,"chart"),d=n("<div></div>").attr("id",s);n(r).append(d);var h=E(u,"legend"),m=n("<div></div>").attr("id",h).addClass("mv-legend");n(r).append(m),this.legendDivId=document.getElementById(h),this.divId=document.getElementById(s)}this.initialized=!0}t.data_graphic({title:this.title,description:this.description,animate_on_load:!0,data:this.values,width:p,height:f,target:this.divId,x_accessor:"date",y_accessor:"value",x_label:this.x_label,y_label:this.y_label,x_extended_ticks:!0,y_extended_ticks:!0,right:w,left:g,bottom:b,legend:this.legend,legend_target:this.legendDivId})},this.refresh=function(e,t){this.x_label=e,this.y_label=t,this.render()}}function u(e,t,n,a,u,r,s,d,h,m,o){for(var v=[],c=0;c<s.length;c++)v[c]=[],v[c].push(new l(new Date,0));return new i(e,t,n,a,u,r,v,s,d,h,m,o)}function r(e,t,n){var l=null,a=e.x_label,i=e.y_label;if(e.ignoreMetricName)for(var u=0;u<e.legendData.length;u++)l=d(n,e.metricType.type,e.legendData[u].metricName,e.legendData[u].altMetricName),s(l,e.legendData[u].key,t,e.values[u]);else{l=d(n,e.metricType.type,e.metricName,null);for(var r=0;r<e.legendData.length;r++)s(l,e.legendData[r].key,t,e.values[r]);if(l&&e.y_label_key)try{i=l[e.y_label_key]}catch(e){}}e.refresh(a,i)}function s(e,t,n,a){var i=0;e&&(i=h(e,t));var u=new l(n,i);for(a.push(u);a.length>c;)a.shift()}function d(e,t,n,l){var a=null;return e[t]&&(a=e[t][n],!a&&l&&(a=e[t][l])),a}function h(e,t){var n=0;try{e[t]&&(n=m(e[t],4))}catch(e){}return n}function m(e,t){t||(t=4);var n=Math.pow(10,t),l=e*n,a=Math.round(l);return a/n}function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}e.addCounter=function(e,t,n,l){var i=[];i.push(new a(l,"count",null,null)),E.push(u(e,"counter",v.COUNTER,l,t,n,i,v.COUNTER.xLabel,v.COUNTER.yLabel,null,!1))},e.addMultiCounter=function(e,t,n,l){if(l.constructor===Array&&l.length){for(var i=[],r=0;r<l.length;r++)i.push(new a(l[r],"count",l[r],null));E.push(u(e,"counter",v.COUNTER,"metricName",t,n,i,v.COUNTER.xLabel,v.COUNTER.yLabel,null,!0))}},e.addGauge=function(e,t,n,l){var i=[];i.push(new a(l,"value",null,null)),E.push(u(e,"gauge",v.GAUGE,l,t,n,i,v.GAUGE.xLabel,v.GAUGE.yLabel,null,!1))},e.addMultiGauge=function(e,t,n,l){if(l.constructor===Array&&l.length){for(var i=[],r=0;r<l.length;r++)i.push(new a(l[r],"value",l[r],null));E.push(u(e,"gauge",v.GAUGE,"metricName",t,n,i,v.GAUGE.xLabel,v.GAUGE.yLabel,null,!0))}},e.addMeter=function(e,t,n,l){var i=[];i.push(new a("1 min","m1_rate",null,null)),i.push(new a("5 min","m5_rate",null,null)),i.push(new a("15 min","m15_rate",null,null)),i.push(new a("Mean","mean_rate",null,null)),E.push(u(e,"meter",v.METER,l,t,n,i,v.METER.xLabel,v.METER.yLabel,"units",!1))},e.addTimer=function(e,t,n,l){var i=[];i.push(new a("Min","min",null,null)),i.push(new a("Mean","mean",null,null)),i.push(new a("Max","max",null,null)),E.push(u(e,"duration",v.TIMER,l,t,n,i,v.TIMER.xLabel,v.TIMER.yLabel,"duration_units",!1));var r=[];r.push(new a("99.9%","p999",null,null)),r.push(new a("99%","p99",null,null)),r.push(new a("98%","p98",null,null)),r.push(new a("95%","p95",null,null)),r.push(new a("75%","p75",null,null)),E.push(u(e,"histogram",v.TIMER,l,t,n,r,v.TIMER.xLabel,v.TIMER.yLabel,"duration_units",!1));var s=[];s.push(new a("1 min","m1_rate",null,null)),s.push(new a("5 min","m5_rate",null,null)),s.push(new a("15 min","m15_rate",null,null)),s.push(new a("Mean","mean_rate",null,null)),E.push(u(e,"frequency",v.TIMER,l,t,n,s,v.TIMER.xLabel,v.TIMER.yLabel,"rate_units",!1))},e.addJvm=function(e,t,n){for(var l=["total","heap"],i=0;i<l.length;i++){var r=[];r.push(new a(o(l[i])+" Init","value","jvm.memory."+l[i]+".init",null)),r.push(new a(o(l[i])+" Used","value","jvm.memory."+l[i]+".used",null)),r.push(new a(o(l[i])+" Max","value","jvm.memory."+l[i]+".max",null)),r.push(new a(o(l[i])+" Committed","value","jvm.memory."+l[i]+".committed",null)),E.push(u(e,l[i],v.GAUGE,"metricName",t,n,r,v.GAUGE.xLabel,"usage",null,!0))}for(var s=["Eden-Space","Survivor-Space","Old-Gen"],d=0;d<s.length;d++){var h=[];h.push(new a(s[d]+" Init","value","jvm.memory.pools.PS-"+s[d]+".init","jvm.memory.pools.Par-"+s[d]+".init")),h.push(new a(s[d]+" Used","value","jvm.memory.pools.PS-"+s[d]+".used","jvm.memory.pools.Par-"+s[d]+".used")),h.push(new a(s[d]+" Max","value","jvm.memory.pools.PS-"+s[d]+".max","jvm.memory.pools.Par-"+s[d]+".max")),h.push(new a(s[d]+" Committed","value","jvm.memory.pools.PS-"+s[d]+"-.committed","jvm.memory.pools.Par-"+s[d]+"-.committed")),E.push(u(e,s[d],v.GAUGE,"metricName",t,n,h,v.GAUGE.xLabel,"usage",null,!0))}var m=[];m.push(new a("Daemon Threads","value","jvm.thread-states.daemon.count",null)),m.push(new a("Deadlocks","value","jvm.thread-states.deadlock.count",null)),m.push(new a("Terminated","value","jvm.thread-states.terminated.count",null)),m.push(new a("Timed Waiting","value","jvm.thread-states.timed_waiting.count",null)),m.push(new a("Blocked","value","jvm.thread-states.blocked.count",null)),m.push(new a("Waiting","value","jvm.thread-states.waiting.count",null)),m.push(new a("Runnable","value","jvm.thread-states.runnable.count",null)),m.push(new a("New","value","jvm.thread-states.new.count",null)),E.push(u(e,"thread",v.GAUGE,"metricName",t,n,m,v.GAUGE.xLabel,"count",null,!0))},e.init=function(){for(var e=0;e<E.length;e++)E[e].render()},e.refresh=function(e){for(var t=new Date,n=0;n<E.length;n++)r(E[n],t,e)},e.clear=function(){for(;E.length;){var e=E.pop();n(e.divId).empty()}};var v={COUNTER:{type:"counters",xLabel:"time",yLabel:"count"},GAUGE:{type:"gauges",xLabel:"time",yLabel:"value"},METER:{type:"meters",xLabel:"time",yLabel:""},TIMER:{type:"timers",xLabel:"time",yLabel:""}};Object.freeze(v);var c=100;Object.freeze(c);var p=650;Object.freeze(p);var f=250;Object.freeze(f);var y=1.2;Object.freeze(y);var g=120;Object.freeze(g);var w=90;Object.freeze(w);var b=50;Object.freeze(b);var E=[]}(window.metricsViewer=window.metricsViewer||{},jQuery),metricsViewer});